import { PartiesTableData, CandidateType } from './types';
import store from 'store'
import uniqBy from 'lodash.uniqby'

export const passingParties = new Map<string, any[]>();

export let winsCandidates: CandidateType[] = []
export const appendToWins = (wins: CandidateType[]) => {
  const allCandidates = winsCandidates.concat(...wins)
  winsCandidates = uniqBy(allCandidates, 'name')
}

export let inputsValue: PartiesTableData = {
  parties: [],
  districts: [],
  threshold: 0,
  turnout: 0,
  table: new Map()
};

export const mockDistricts = [211,	212,	213,	214,	215,	216,	217,	218,	219,	220,	221,	222,	223 ]
export const mockParties = [
  'СЛУГА НАРОДУ(тест)',
  'Європейська Солідарність',
  'ГОЛОС',
  'Всеукраїнське об’єднання "Батьківщина"',
  'ОПОЗИЦІЙНА ПЛАТФОРМА – ЗА ЖИТТЯ',
  'СИЛА І ЧЕСТЬ',
  'ПАРТІЯ ШАРІЯ',
  'Всеукраїнське об’єднання "Свобода"',
  'УКРАЇНСЬКА СТРАТЕГІЯ ГРОЙСМАНА',
  'Громадянська позиція',
  'ОПОЗИЦІЙНИЙ БЛОК',
  'РАДИКАЛЬНА ПАРТІЯ ОЛЕГА ЛЯШКА',
  'Рух Нових Сил Михайла Саакашвілі',
  'Об’єднання "САМОПОМІЧ"',
  'ПАРТІЯ ЗЕЛЕНИХ УКРАЇНИ',
  "Аграрна партія України",
  'Сила Людей',
  'СИЛА ПРАВА',
  'СОЦІАЛЬНА СПРАВЕДЛИВІСТЬ',
  'НЕЗАЛЕЖНІСТЬ',
  'ПАТРІОТ',
  'ВСЕУКРАЇНСЬКЕ ОБ’ЄДНАННЯ "ФАКЕЛ"'
]

const votersByParty = [
  [ 28774, 	35591, 	33721,	28008,	30183,	30500,	28006,	27147,	29866,	26328,	25577,	27457,	25336 ],
  [ 15556, 16445,	12257, 14169,	10993,	9687,	14004,	12096,	12592,	11697,	16009,	12108,	14648 ],
  [ 9701,	10655,	7063,	8183, 5830,	5962,	8037,	7384,	7194,	7065,	9219,	7349,	8861  ],
  [ 6987,	7462, 6838,	6919,	6852,	6074,	6921,	6527,	7853,	5964,	6494,	5755,	6308 ],
  [ 6087, 6634,	5591,	7116,	5896,	5272,	7294,	5165,	5484,	5011,	8316,	5788,	6879],
  [4388,	4856,	4402,	4630,	4065,	3898,	4879,	4421,	4868,	3835,	4607,	4153,	4205  ],
  [2718,	2958,	2242,	2623,	2135,	2120,	2567,	2205,	2358,	2089,	2844,	2704,	2604  ], 
  [2250,	2085,	1915,	1903,	2625,	1548,	2235,	1932,	2138,	1786,	1908,	1866,	2404  ],
  [1785,	1961,	1901,	1539,	1614,	1733,	1724,	1796,	2063,	1824,	1656,	1813,	1785  ],
  [1593,	1949,	1510,	1520,	1167,	1308,	1557,	1323,	1342,	1307,	1483,	1259,	1574  ],
  [1145,	1401,	997,	1324,	1017,	1003,	1075,	854,	1051,	870,	1574,	1121,	1339  ],
  [971,	962,	1063,	943,	1099,	1084,	1025,	1101,	1417,	997,	746,	997,	959  ],
  [792,	970,	696,	826, 645,	649,	788,	713,	840,	686,	860,	675,	803,  ],
  [527,	606,	450,	512,	394,	491,	463,	528,	495,	478,	550,	489,	466,  ],
  [ 325,	332,	386,	314,	333,	316,	336,	321,	373,	306,	320,	336,	347 ],
  [ 167,	217,	129,	141,	101,	121,	117,	123,	138,	127,	221,	116,	184 ],
  [ 95,	143,	112,	121,	82,	97,	98,	113,	84,	89,	135,	78,	132 ],
  [ 80,	83,	86,	77,	127,	100,	74,	75,	104,	62,	81,	72,	79],
  [ 68,	83,	103,	78,	74,	86,	90,	49,	85,	66,	251,	67,	79 ],
  [ 54,	42,	39,	23,	18,	40,	26,	34,	44,	37,	55,	26,	32 ],
  [ 38,	45,	87,	31,	39,	44,	42,	35,	54,	41,	87,	61,	34 ],
  [ 20,	28,	16,	17,	20,	13,	20,	9,	13,	17,	21,	18,	20 ]

]

export const mockDistrictsAllVoter = [ 84121,	95508,	81604,	81017,	75309,	72146,	81378,	73951,	80456,	70682,	83014,	74308,	79078 ]

const fillMockTable = () => {
  const map = new Map()
  mockParties.forEach((party, i) => map.set(party, votersByParty[i]))
  return map;
}

export const mockPartiesVotesSum = [ 376494, 172261, 102503, 86954, 80533  ]

export const mockInputsValue: PartiesTableData = {
  ...inputsValue,
  parties: mockParties,
  districts: mockDistricts,
  threshold: 5,
  turnout: 100,
  table: fillMockTable()
}
const mockPassingPartiesArray = mockParties.slice(0,5)
export const mockPassingParties = (() => {
  const map = new Map()
  mockPassingPartiesArray.forEach((party, i) => {
    map.set(party, new Array(mockInputsValue.districts.length).fill(0))
  })
  return map
})()

const mockCandidates: CandidateType[] = [
  { name: 'Симоненко', party: 'Слуга Народу', number: '1', district: '223', voters: 101 },
  { name: 'Петренко', party: 'Слуга Народу', number: '2', district: '223', voters: 30 },
  { name: 'Павленко', party: 'Слуга Народу', number: '3', district: '223', voters: 1755 },
  { name: 'Тимошенко', party: 'Слуга Народу', number: '4', district: '223', voters: 1500 },
  { name: 'Іваненко', party: 'Слуга Народу', number: '5', district: '223', voters: 900 },
  { name: 'Степаненко', party: 'Слуга Народу', number: '6', district: '223', voters: 2500 },
]

const defaultVotersByDistrict = {"11":173066,"12":178455,"13":146372,"14":160031,"15":148825,"16":134650,"17":157587,"18":135774,"19":139721,"20":157877,"21":152892,"22":155661,"23":159063,"24":151546,"25":141964,"26":136054,"27":135413,"28":141286,"29":143637,"30":155634,"31":164015,"32":164900,"33":139327,"34":146751,"35":158600,"36":150040,"37":143786,"38":145286,"39":145242,"40":139990,"45":45697,"46":150483,"47":133737,"48":147647,"49":144119,"50":153624,"51":2690,"52":63562,"57":162653,"58":156178,"59":153824,"60":121396,"62":166744,"63":158985,"64":157729,"65":148560,"66":163943,"67":166420,"68":155869,"69":156348,"70":162099,"71":152559,"72":172496,"73":146339,"74":136368,"75":154746,"76":157161,"77":135637,"78":150194,"79":166264,"80":156176,"81":156035,"82":151370,"83":168358,"84":162493,"85":137490,"86":144360,"87":147629,"88":154822,"89":140128,"90":149219,"91":148807,"92":148820,"93":139023,"94":152186,"95":203059,"96":185644,"97":179516,"98":177418,"99":164745,"100":146957,"101":139333,"102":140895,"103":142863,"105":9714,"106":102674,"107":103634,"112":65550,"113":146757,"114":106583,"115":169548,"116":171494,"117":169673,"118":171519,"119":148810,"120":150070,"121":168621,"122":179000,"123":153090,"124":143060,"125":159488,"126":146789,"127":144465,"128":162459,"129":144328,"130":137225,"131":151201,"132":137316,"133":168346,"134":169569,"135":176427,"136":177292,"137":131551,"138":145422,"139":172144,"140":184015,"141":150713,"142":153900,"143":138859,"144":146118,"145":151637,"146":135741,"147":134366,"148":140882,"149":137769,"150":140306,"151":133479,"152":164331,"153":172871,"154":172630,"155":174838,"156":168989,"157":170049,"158":164955,"159":131352,"160":133570,"161":134625,"162":134794,"163":171737,"164":165109,"165":170071,"166":161904,"167":144180,"168":160054,"169":158441,"170":152805,"171":149042,"172":151660,"173":142826,"174":153165,"175":142462,"176":140102,"177":145576,"178":134279,"179":147728,"180":136007,"181":150032,"182":155095,"183":158378,"184":165921,"185":167626,"186":173061,"187":143785,"188":149279,"189":142321,"190":145124,"191":130024,"192":143303,"193":147223,"194":140182,"195":140071,"196":140863,"197":134557,"198":138397,"199":134212,"200":149646,"201":174116,"202":175923,"203":175205,"204":164921,"205":143417,"206":141086,"207":129567,"208":130393,"209":132982,"210":139790,"211":178906,"212":190426,"213":167120,"214":165496,"215":161343,"216":157422,"217":162396,"218":150675,"219":163041,"220":149944,"221":181586,"222":166540,"223":171902,"unknow":435133}

const initialMockStore = () => {
  store.set(mockPassingPartiesArray[0],mockCandidates)
  const voters = store.get('voters')
  if (!voters) {
    store.set('voters', defaultVotersByDistrict)
  }
}

initialMockStore()